/* set the program's entry point to the Sanity module's main() function */
Program.main = null;
Program.heap = 0x100;
Program.stack = 0x100;
var SourceDir = xdc.module("xdc.cfg.SourceDir");
SourceDir.verbose = 7;
SourceDir.outputDir = "src/" + Program.name + ".src";

var Memory = xdc.useModule("xdc.runtime.Memory");
Memory.defaultHeapSize = 0x40;

print("PERIPHERALS:");
for (var name in Program.cpu.attrs.peripherals) {
    print(name);
    var peripheral = Program.cpu.attrs.peripherals[name].$orig;
    print("    " + peripheral.$name);

    /* check that peripherals are fully defined */
    for (var prop in peripheral) {
        var value = peripheral[prop];
        print("        " + name + "." + prop + ": " + value);
        if (value === undefined && prop != "owner") {
            Program.$logError(prop + " is undefined", peripheral, prop);
        }
    }
}

print("\nMEMORY:");
for (var prop in Program.cpu.memoryMap) {
    print("    " + Program.cpu.memoryMap[prop].name
        + ", 0x" + Program.cpu.memoryMap[prop].base.toString(16)
        + ", 0x" + Program.cpu.memoryMap[prop].len.toString(16));
}
